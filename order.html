<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MAGAYON POS</title>

  <!-- REQUIRED for tablet + PWA -->
  <meta name="viewport"
        content="width=device-width,
                 initial-scale=1.0,
                 maximum-scale=1.0,
                 user-scalable=no" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1f1f1f">

  <!-- POS STYLES -->
  <link rel="stylesheet" href="order.css" />
</head>

<body>

<div class="top-bar">

  <!-- LEFT -->
  <div class="pos-title" oncontextmenu="unlockPOS(); return false;">
    POS
  </div>

  <!-- CENTER -->
  <div class="pos-status">
    <span id="statusBadge" class="status hidden"></span>
    <span id="pendingBadge" style="font-weight:bold"></span>
    <button id="syncOrdersBtn" class="sync-orders-btn" disabled>
  No Orders to Sync
</button>
  </div>

  <!-- RIGHT -->
  <div class="top-right">
    <div class="top-actions">
      <button id="fullscreenBtn" class="top-btn">â›¶</button>
      <button class="active">Main</button>
      <button id="stocksBtn">Stocks</button>
      <button id="salesBtn">Sales</button>
      <button id="refreshStockBtn" class="top-btn">ðŸ”„</button>
      <button id="logoutBtn" class="danger">Logout</button>
    </div>

    <!-- ðŸ‘¤ CASHIER INFO (INLINE) -->
    <div class="cashier-info">
      <span><b>Cashier:</b> <span id="cashierName"></span></span>
      <span><b>Position:</b> <span id="cashierPosition"></span></span>
      <span><b>Location:</b> <span id="cashierLocation"></span></span>
    </div>
  </div>

</div>

<!-- ================= CATEGORIES ================= -->
<div class="categories-top" id="categoryList"></div>

<!-- ================= MAIN LAYOUT ================= -->
<div class="pos-container">

  <!-- PRODUCTS -->
  <main class="products-panel">
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Search products" />
    </div>

    <div id="productGrid" class="product-grid"></div>
  </main>

  <!-- CART -->
  <aside class="cart-panel">
    <div class="cart-table-wrapper">
      <table class="cart-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Product</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody id="orderTable"></tbody>
      </table>
    </div>

    <div class="cart-summary">
      <div class="total-line">
        <span>SUM TOTAL:</span>
        <span>â‚±<span id="sumTotal">0.00</span></span>
      </div>
    </div>

    <div class="cart-actions">
      <button id="clearOrderBtn" class="btn-clear">Clear</button>
      <button class="btn-checkout checkout">Checkout</button>
      <button class="btn-print">Print</button>
    </div>
  </aside>

</div>

<!-- ================= GLOBAL LOADER ================= -->
<div id="globalLoader" class="loader hidden">
  <div class="spinner"></div>
  <div class="loader-text">Loading dataâ€¦</div>
</div>

<!-- ================= PAYMENT MODAL ================= -->
<div id="paymentModal" class="modal hidden">
  <div class="modal-content payment-ui">

    <div class="payment-header">
      <h2>Payment</h2>
      <span class="payment-method-badge" id="methodBadge">CASH</span>
    </div>

    <div class="payment-summary">
      <div class="summary-row total">
        <span>Total</span>
        <strong id="payTotal">â‚±0.00</strong>
      </div>
      <div class="summary-row paid">
        <span>Paid</span>
        <strong id="paidDisplay">â‚±0.00</strong>
      </div>
      <div class="summary-row change">
        <span>Change</span>
        <strong id="changeAmount">â‚±0.00</strong>
      </div>
    </div>

    <select id="paymentMethod" class="payment-method">
      <option value="CASH">Cash</option>
      <option value="GCASH">GCash</option>
    </select>

    <div class="keypad">
      <button onclick="keypadInput('7')">7</button>
      <button onclick="keypadInput('8')">8</button>
      <button onclick="keypadInput('9')">9</button>
      <button onclick="keypadInput('4')">4</button>
      <button onclick="keypadInput('5')">5</button>
      <button onclick="keypadInput('6')">6</button>
      <button onclick="keypadInput('1')">1</button>
      <button onclick="keypadInput('2')">2</button>
      <button onclick="keypadInput('3')">3</button>
      <button class="key-wide" onclick="keypadInput('0')">0</button>
      <button onclick="keypadInput('.')">.</button>
      <button class="key-back" onclick="keypadBackspace()">âŒ«</button>
    </div>

    <div id="gcashRefRow" class="gcash-row hidden">
      <input id="gcashRef" placeholder="GCash Reference (optional)">
    </div>

    <div class="modal-actions">
      <button class="btn-cancel" onclick="closePaymentModal()">Cancel</button>
      <button id="confirmPaymentBtn" class="btn-confirm" onclick="confirmPayment()">Confirm</button>
    </div>

  </div>
</div>

<!-- ================= STOCKS MODAL ================= -->
<div id="stocksModal" class="modal hidden">
  <div class="modal-content">
    <h2>ðŸ“¦ Inventory Stocks (Today)</h2>
    <table class="cart-table">
      <thead>
        <tr>
          <th>Item</th>
          <th>Added Today</th>
          <th>Remaining</th>
        </tr>
      </thead>
      <tbody id="stocksTable"></tbody>
    </table>
    <div class="modal-actions">
      <button onclick="closeStocks()">Close</button>
    </div>
  </div>
</div>

<!-- ================= SALES MODAL ================= -->
<div id="salesModal" class="modal hidden">
  <div class="modal-content">
    <h2>ðŸ“Š Todayâ€™s Sales</h2>
    <table class="cart-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Transaction / Product</th>
          <th>Qty</th>
          <th>Cashier</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="salesBody"></tbody>
    </table>
    <div class="cart-summary">
      <b>Gross Sales:</b> â‚±<span id="sumGross">0.00</span>
    </div>
    <div class="modal-actions">
      <button onclick="closeSales()">Close</button>
    </div>
  </div>
</div>

<!-- ================= PIN MODAL ================= -->
<div id="pinModal" class="modal hidden" style="z-index:9999">
  <div class="modal-content" style="max-width:360px;text-align:center">
    <h2>ðŸ”’ Manager Unlock</h2>
    <p>Enter Manager PIN</p>
    <input id="pinInput" type="password" inputmode="numeric" />
    <div class="modal-actions">
      <button onclick="closePinModal()">Cancel</button>
      <button onclick="unlockPOS()">Unlock</button>
    </div>
  </div>
</div>

<!-- ================= SCRIPTS ================= -->
<script src="offline-db.js"></script>
<script type="module" src="order.js"></script>

</body>
</html>