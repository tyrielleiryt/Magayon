<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MAGAYON POS</title>
    <!-- âœ… REQUIRED for tablet + PWA -->
  
  <meta name="viewport"
        content="width=device-width,
                 initial-scale=1.0,
                 maximum-scale=1.0,
                 user-scalable=no" />

  <!-- âœ… PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1f1f1f">

  <!-- POS STYLES -->
  <link rel="stylesheet" href="order.css" />
</head>
<body>

  <!-- ================= TOP BAR ================= -->
  <div class="top-bar">
    <div class="pos-title" oncontextmenu="unlockPOS(); return false;">
  POS
</div>

  <!-- âœ… OFFLINE INDICATOR (CORRECT PLACE) -->
  <span id="statusBadge" class="status hidden"></span>
 <!-- âœ… PENDING OFFLINE ORDERS -->
<span id="pendingBadge" style="margin-left:8px;font-weight:bold"></span>

    <div class="top-actions">
      <button id="fullscreenBtn" class="top-btn">â›¶ Full Screen</button>
      <!--<button>Ongoing Orders</button>
      <button>Completed Orders</button>
      <button>Cancelled Orders</button> -->
      <button class="active">Main Page</button>
      <button id="stocksBtn">Stocks List</button>
      <button id="salesBtn">Sales Report</button>
      <button id="logoutBtn" class="danger">Logout</button>
      <button id="refreshStockBtn" class="top-btn" title="Refresh stock">
  ðŸ”„
</button>
    </div>

    <div class="cashier-info">
  <div><b>Cashier:</b> <span id="cashierName"></span></div>
  <div><b>Position:</b> <span id="cashierPosition"></span></div>
  <div><b>Location:</b> <span id="cashierLocation"></span></div>
  
</div>
  </div>

  <!-- ================= CATEGORIES (TOP) ================= -->
<div class="categories-top" id="categoryList">
  <!-- categories injected by order.js -->
</div>


  <!-- ================= MAIN LAYOUT ================= -->
  <div class="pos-container">

    <!-- ========== CENTER : PRODUCTS ========== -->
    <main class="products-panel">
      <div class="search-box">
        <input type="text" id="searchInput" placeholder="Search products" />
      </div>

      <div id="productGrid" class="product-grid">
        <!-- Product cards injected by order.js -->
      </div>
    </main>

    <!-- ========== RIGHT : CART ========== -->
    <aside class="cart-panel">
  <div class="cart-table-wrapper">
    <table class="cart-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Product</th>
          <th>Qty</th>
          <th>Price</th>
          <th>Total</th>
        </tr>
      </thead>

      <tbody id="orderTable">
        <!-- Cart rows injected by JS -->
      </tbody>
    </table>
  </div>

  <div class="cart-summary">
    <div class="total-line">
      <span>SUM TOTAL:</span>
      <span>â‚±<span id="sumTotal">0.00</span></span>
    </div>
  </div>

  <div class="cart-actions">
    <button id="clearOrderBtn" class="btn-clear">Clear</button>
    <button class="btn-checkout checkout">Checkout</button>
    <button class="btn-print">Print</button>
  </div>
</aside>

  </div>

  <!-- ================= GLOBAL LOADER ================= -->
<div id="globalLoader" class="loader hidden">
  <div class="spinner"></div>
  <div class="loader-text">Loading dataâ€¦</div>
</div>


  <!-- ================= Payment ================= -->
<div id="paymentModal" class="modal hidden">
  <div class="modal-content payment-ui">

  <div class="payment-header">
    <h2>Payment</h2>
    <span class="payment-method-badge" id="methodBadge">CASH</span>
  </div>

  <div class="payment-summary">
    <div class="summary-row total">
      <span>Total</span>
      <strong id="payTotal">â‚±0.00</strong>
    </div>

    <div class="summary-row paid">
      <span>Paid</span>
      <strong id="paidDisplay">â‚±0.00</strong>
    </div>

    <div class="summary-row change">
      <span>Change</span>
      <strong id="changeAmount">â‚±0.00</strong>
    </div>
  </div>

  <select id="paymentMethod" class="payment-method">
    <option value="CASH">Cash</option>
    <option value="GCASH">GCash</option>
  </select>

  <div class="keypad">
    <button onclick="keypadInput('7')">7</button>
    <button onclick="keypadInput('8')">8</button>
    <button onclick="keypadInput('9')">9</button>

    <button onclick="keypadInput('4')">4</button>
    <button onclick="keypadInput('5')">5</button>
    <button onclick="keypadInput('6')">6</button>

    <button onclick="keypadInput('1')">1</button>
    <button onclick="keypadInput('2')">2</button>
    <button onclick="keypadInput('3')">3</button>

    <button class="key-wide" onclick="keypadInput('0')">0</button>
    <button onclick="keypadInput('.')">.</button>
    <button class="key-back" onclick="keypadBackspace()">âŒ«</button>
  </div>

  <div id="gcashRefRow" class="gcash-row hidden">
    <input type="text" id="gcashRef" inputmode="text" placeholder="GCash Reference (optional)">
  </div>

<div class="modal-actions">
  <button class="btn-cancel" onclick="closePaymentModal()">Cancel</button>
  <button
    id="confirmPaymentBtn"
    class="btn-confirm"
    onclick="confirmPayment()"
  >
    Confirm
  </button>
</div>


</div>
    </div>
    
<!-- ================= STOCKS MODAL ================= -->
<div id="stocksModal" class="modal hidden">
  <div class="modal-content">
    <h2>ðŸ“¦ Inventory Stocks (Today)</h2>

    <table class="cart-table">
      <thead>
        <tr>
          <th>Item</th>
          <th>Added Today</th>
          <th>Remaining</th>
        </tr>
      </thead>
      <tbody id="stocksTable"></tbody>
    </table>

    <div class="modal-actions">
      <button onclick="closeStocks()">Close</button>
    </div>
  </div>
</div>

<!-- ================= SALES MODAL ================= -->
<div id="salesModal" class="modal hidden">
  <div class="modal-content">
    <h2>ðŸ“Š Todayâ€™s Sales</h2>

    <table class="cart-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Transaction / Product</th>
          <th>Qty</th>
          <th>Cashier</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="salesBody"></tbody>
    </table>

    <div class="cart-summary" style="margin-top:10px">
      <b>Gross Sales:</b> â‚±<span id="sumGross">0.00</span>
    </div>

    <div class="modal-actions">
      <button onclick="closeSales()">Close</button>
    </div>
  </div>
</div>

<!-- ================= MANAGER PIN MODAL ================= -->
<div id="pinModal" class="modal hidden" style="z-index:9999">
  <div class="modal-content" style="max-width:360px;text-align:center">

    <h2>ðŸ”’ Manager Unlock</h2>
    <p style="margin-bottom:12px">Enter Manager PIN to exit lock</p>

    <input
      id="pinInput"
      type="password"
      inputmode="numeric"
      placeholder="Enter PIN"
      style="
        width:100%;
        padding:12px;
        font-size:20px;
        text-align:center;
        letter-spacing:6px;
      "
    />

    <div class="modal-actions" style="margin-top:16px">
      <button class="btn-cancel" onclick="closePinModal()">Cancel</button>
      <button class="btn-confirm" onclick="unlockPOS()">Unlock</button>
    </div>

  </div>
</div>

  <!-- ================= SCRIPT ================= -->
   <script src="offline-db.js"></script>
  <script type="module" src="order.js"></script>
  
</body>
</html>
